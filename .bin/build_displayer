#!/bin/bash

set -e

cd `dirname "$0"`
cd ../displayer

# Run type checks (vite doesn't)
./node_modules/.bin/tsc --noEmit

# Build
./node_modules/.bin/vite build --assetsDir 'displayer'

# Tar index and assets and place in app
# WARN Be sure to avoid including a dev dir in the tar
# WARN `assets` dir is reserved for message assets, so displayer assets put in `displayer` dir
cd dist
tar --create --file ../../app/static/displayer.tar index.html displayer
